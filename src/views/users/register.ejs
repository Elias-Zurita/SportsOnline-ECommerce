<!DOCTYPE html>
<html>

  <%- include('../partials/head.ejs') %>  <!--  Incluye el HEAD y se usan los .. (dos puntos) para que salga de la carpeta user y vaya a partials -->

  <body>

  <%- include('../partials/header.ejs') %>  <!--  Incluye el HEADER y se usan los .. (dos puntos) para que salga de la carpeta user y vaya a partials -->


    <div class="topHeader">
    
      <form action="/users/register" method="POST" class="formularioLog" enctype="multipart/form-data"> <!-- Formulario para crear usuario. Ademas tienen el "enctype=multipart..."" para subir imagen -->
        <h2 class="h-2">CREA TU CUENTA!</h2>
          
          <div class="capa"></div>

          <div class="mb-3">
            <label>Nombre:</label>
              <input 
                type="text" 
                name="nombre" 
                class="form-control <%= locals.errors && errors.nombre ? 'is-invalid' : null %>"
                value="<%= locals.oldData ? oldData.nombre: null %>"> <!-- Mantiene en pantalla los datos que se fueron agregando del usuario -->
                <% if (locals.errors && errors.nombre) {%>   <!-- Si en las variables locales vino errors y si en erros vino un error en nombre -->
                  <div class="text-danger">
                    <p><%= errors.nombre.msg %></p> <!-- muestra el mensaje que debe llenar el campo de nombre -->
                  </div>
                <% } %>  
 
            <label>Apellido:</label>
              <input 
                type="text"
                name="apellido"
                class="form-control <%= locals.errors && errors.apellido ? 'is-invalid' : null %>"
                value="<%= locals.oldData ? oldData.apellido: null %>"> <!-- Mantiene en pantalla los datos que se fueron agregando del usuario -->
                <% if (locals.errors && errors.apellido) {%>   <!-- Si en las variables locales vino errors y si en erros vino un error en apellido -->
                  <div class="text-danger">
                    <p><%= errors.apellido.msg %></p> <!-- muestra el mensaje que debe llenar el campo de apellido -->
                  </div>
                <% } %>  
                                                 
            <label>Email: </label>
              <input 
                type="email" 
                name="email"
                class="form-control <%= locals.errors && errors.email ? 'is-invalid' : null %>"
                value="<%= locals.oldData ? oldData.email: null %>"> <!-- Mantiene en pantalla los datos que se fueron agregando del usuario -->
                <% if (locals.errors && errors.email) {%>   <!-- Si en las variables locales vino errors y si en erros vino un error en email -->
                  <div class="text-danger">
                    <p><%= errors.email.msg %></p> <!-- muestra el mensaje que debe llenar el campo de email -->
                  </div>
                <% } %>  
                     

                <div class="control-formulario">
                  <label for="perfil">Perfil</label>
                      <select name= "perfil">
                          <% perfil.forEach(perfil=>{ %>  <!-- para cada elemento de la tabla de perfil DEBERIA LLEVAR PERFILES AL PRINCIPIO POR QUE ES LO QUE LLAMA DESDE EL CONTROLLER PERO NO FUNCIONA -->
                          <option value="<%= perfil.id%>">  <!-- las opciones seran los id -->
                          <%= perfil.nombre %>     <!-- el .nombre es por "nombre" del modelo de perfil -->
                          </option>
                          <% }) %>
                      </select>
                      <% if (locals.errors && errors.perfil) {%>   <!-- Si en las variables locales vino errors y si en erros vino un error en perfil -->
                          <div class="text-danger">
                              <p><%= errors.perfil.msg %></p> <!-- muestra el mensaje que debe llenar el campo de perfil -->
                          </div>
                      <% } %>  
              </div>
                                
            <label>Contraseña: </label>
              <input 
                type="password"
                name="contraseña"
                class="form-control <%= locals.errors && errors.contraseña ? 'is-invalid' : null %>"
                value="<%= locals.oldData ? oldData.password: null %>"> <!-- Mantiene en pantalla los datos que se fueron agregando del usuario -->
                <% if (locals.errors && errors.contraseña) {%>   <!-- Si en las variables locales vino errors y si en erros vino un error en contraseña -->
                  <div class="text-danger">
                    <p><%= errors.contraseña.msg %></p> <!-- muestra el mensaje que debe llenar el campo de contraseña -->
                  </div>
                <% } %>  
                     
                <div class="row">
                  <label>Sube tu imagen de perfil: </label>
                    <input 
                      type="file"
                      name= "avatar"
                      class="form-control">  <!-- El name "avatar" es importante usarlo en el archivo de routes users -->
                      <% if (locals.errors && errors.avatar) {%>   <!-- Si en las variables locales vino errors y si en erros vino un error en subir avatar -->
                        <div class="text-danger">
                          <p><%= errors.avatar.msg %></p> <!-- muestra el mensaje que debe llenar el subir un avatar -->
                        </div>
                      <% } %>  
                </div>
  
                <div class="row">
                  <button type="submit" class="btn btn-success col-4 mt-5">Registrarse</button>
                </div>
                     
                  <input class="robot" type="checkbox" checked="" name="No soy un robot" id="No-robot">
                    <label class="required" for="terminos-registro">No soy un robot</label>
          </div>        
                            
        </div>
            
      </form>
        
                  
    <%- include('../partials/footer.ejs') %>
               
  </body>

</html>
